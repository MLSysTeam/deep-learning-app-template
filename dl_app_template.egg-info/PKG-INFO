Metadata-Version: 2.4
Name: dl-app-template
Version: 0.1.0
Summary: A deep learning app template with Streamlit frontend and FastAPI backend
Author-email: Your Name <your.email@example.com>
License: MIT
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: fastapi>=0.68.0
Requires-Dist: uvicorn[standard]>=0.15.0
Requires-Dist: torch>=1.9.0
Requires-Dist: torchvision>=0.10.0
Requires-Dist: streamlit>=1.0.0
Requires-Dist: sqlalchemy>=1.4.0
Requires-Dist: pymysql>=1.0.0
Requires-Dist: pillow>=8.0.0
Requires-Dist: python-multipart>=0.0.5
Requires-Dist: python-dotenv>=0.19.0
Provides-Extra: dev
Requires-Dist: pytest>=6.0; extra == "dev"
Requires-Dist: black>=21.0; extra == "dev"
Requires-Dist: flake8>=3.9; extra == "dev"
Requires-Dist: mypy>=0.910; extra == "dev"

# Deep Learning Application Template

A complete deep learning application template featuring a Streamlit frontend, FastAPI backend, and MySQL database for image classification tasks.

## ğŸ—ï¸ System Architecture

This application follows a modern, scalable architecture:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP Requests     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚                  â”‚
â”‚   Streamlit     â”‚                      â”‚   FastAPI        â”‚
â”‚   Frontend      â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Backend        â”‚
â”‚                 â”‚                      â”‚                  â”‚
â”‚ (User Interface)â”‚                      â”‚ (Business Logic) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â”‚
                                                  â”‚ Image Preprocessing
                                                  â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚                         â”‚
                                      â”‚    PyTorch Model        â”‚
                                      â”‚   (Inference Logic)     â”‚
                                      â”‚                         â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â”‚ Prediction Results
                                                  â–¼
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                      â”‚                         â”‚
                                      â”‚        MySQL            â”‚
                                      â”‚      Database           â”‚
                                      â”‚                         â”‚
                                      â”‚ â€¢ Image Path            â”‚
                                      â”‚ â€¢ Predicted Class       â”‚
                                      â”‚ â€¢ Confidence Score      â”‚
                                      â”‚ â€¢ Detection Time        â”‚
                                      â”‚                         â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
Flow:
User uploads image â†’ Streamlit sends to FastAPI â†’ FastAPI preprocesses image â†’ 
â†’ PyTorch model performs inference â†’ Results stored in MySQL â†’ 
â†’ Response to Streamlit â†’ Display to user
```

### Frontend Layer
- **Streamlit**: Provides an interactive UI for uploading images and viewing classification results
- Handles image display and prediction visualization
- Communicates with the backend via REST APIs

### Backend Layer
- **FastAPI**: High-performance web framework for creating REST APIs
- Handles image preprocessing and model inference
- Manages communication with the database
- Implements async request handling

### Machine Learning Layer
- **PyTorch/TorchVision**: For implementing and running image classification models
- Includes preprocessing pipelines and prediction logic
- Designed to work with standard image classification architectures

### Data Layer
- **MySQL**: Stores classification results including:
  - Image file paths
  - Predicted class labels
  - Confidence scores
  - Timestamps of predictions

## ğŸš€ Getting Started

### Prerequisites

- Python 3.8+
- MySQL Server
- [UV](https://github.com/astral-sh/uv) package manager

### Installation

1. Clone this repository:
   ```bash
   git clone <repository-url>
   cd <repository-name>
   ```

2. Install dependencies using UV:
   ```bash
   uv sync
   # Or if you prefer pip:
   pip install -r requirements.txt
   ```

3. Set up the MySQL database:
   - Create a database for image classifications
   - Update the database credentials in `.env` (see `.env.example`)

4. Copy the environment example file:
   ```bash
   cp .env.example .env
   ```
   
   Then update `.env` with your database credentials.

### Running the Application

#### Method 1: Separate Terminals

1. Start the backend (in terminal 1):
   ```bash
   ./start_backend.sh
   ```
   Or run directly:
   ```bash
   uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
   ```

2. Start the frontend (in terminal 2):
   ```bash
   ./start_frontend.sh
   ```
   Or run directly:
   ```bash
   streamlit run app/frontend.py
   ```

#### Method 2: Using Process Manager

Alternatively, you can start both services using a process manager like `pm2`:

1. Install pm2:
   ```bash
   npm install -g pm2
   ```

2. Start both services:
   ```bash
   pm2 start ecosystem.config.js
   ```

> Note: Create an `ecosystem.config.js` file if using PM2 (not included in this template).

### Usage

1. Access the Streamlit frontend at `http://localhost:8501`
2. Upload an image file (JPG, PNG, etc.)
3. Click "Classify Image" to send the image to the backend
4. View the classification result on the frontend
5. Results are stored in the MySQL database

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py          # FastAPI backend application
â”‚   â”œâ”€â”€ frontend.py      # Streamlit frontend application
â”‚   â”œâ”€â”€ database.py      # Database models and connection
â”‚   â””â”€â”€ model_handler.py # ML model handling logic
â”œâ”€â”€ uploads/             # Directory for storing uploaded images
â”œâ”€â”€ pyproject.toml       # Project dependencies and metadata
â”œâ”€â”€ requirements.txt     # Dependencies list
â”œâ”€â”€ .env.example         # Environment variables example
â”œâ”€â”€ start_backend.sh     # Script to start backend service
â”œâ”€â”€ start_frontend.sh    # Script to start frontend service
â”œâ”€â”€ README.md            # This file
â””â”€â”€ README_zh.md         # Chinese version of README
```

## ğŸ”§ Customization

### Adding Your Own Model

To integrate your own PyTorch model:

1. Modify [app/model_handler.py](app/model_handler.py) to load your model:
   - Update the `__init__` method to load your specific model
   - Adjust the `predict` method to handle your model's input/output format
   - Modify the `preprocess_image` method if your model requires different preprocessing

2. Update the classification classes if needed:
   - Replace the example ImageNet classes with your specific classes

### Database Schema

The application creates the following table automatically:

```sql
CREATE TABLE image_classifications (
    id INTEGER AUTO_INCREMENT PRIMARY KEY,
    image_path VARCHAR(255),
    predicted_class VARCHAR(100),
    confidence VARCHAR(10),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## ğŸ› ï¸ Technologies Used

- **Frontend**: Streamlit
- **Backend**: FastAPI
- **Database**: MySQL
- **ML Framework**: PyTorch, TorchVision
- **Package Management**: UV, pip
- **Image Processing**: Pillow

## ğŸ¤ Contributing

Contributions are welcome! Feel free to submit a pull request or open an issue to improve this template.

## ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.
